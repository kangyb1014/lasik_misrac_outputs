{
  "user_message": "<misra_rule>\nMISRA C 2023 Rule 14.3 is: Controlling expressions shall not be invariant.\nHere are exceptions to this rule:\n1. Invariants that are used to create infinite loops are permitted.\n2. A do-while loop with an essentially Boolean controlling expression that evaluates to false and satisfies the constraints and semantics for an integer constant expression is permitted.\n</misra_rule>\n<response format>\nProvide your answer with these fields.\n- is_rule_violated: whether the rule is violated or not (true/false),\n- scenario: a specific violation scenario.\n</response format>\n<target_code>\nHere is the code of MHD_str_to_uint64_n_:\n```c\nsize_t\nMHD_str_to_uint64_n_ (const char *str,\n                      size_t maxlen,\n                      uint64_t *out_val)\n{\n  uint64_t res;\n  size_t i;\n\n  if (! str || ! maxlen || ! out_val || ! isasciidigit (str[0]))\n    return 0;\n\n  res = 0;\n  i = 0;\n  do\n  {\n    const int digit = (unsigned char) str[i] - '0';\n\n    if ( (res > (UINT64_MAX / 10)) ||\n         ( (res == (UINT64_MAX / 10)) &&\n           ((uint64_t) digit > (UINT64_MAX % 10)) ) )\n      return 0;\n\n    res *= 10;\n    res += (unsigned int) digit;\n    i++;\n  } while ( (i < maxlen) &&\n            isasciidigit (str[i]) );\n\n  *out_val = res;\n  return i;\n}\n```\n</target_code>\n<additional code>Here are the definitions of symbols that are close to the target function MHD_str_to_uint64_n_:\n_MHD_static_inline bool\nisasciidigit (char c)\n{\n  return (c >= '0') && (c <= '9');\n}\n</additional code>\n<target_code>\nHere is the code fragment that you need to analyze:\n```c\nif (! str || ! maxlen || ! out_val || ! isasciidigit (str[0]))\n    return 0;\n```\nFocus on the above code fragment and judge whether it violates the rule 14.3 or not.\n</target_code>\n",
  "is_rule_violated": false,
  "scenario": "Not violated: the controlling expression depends on function parameters (str, maxlen, out_val) and on the runtime result of isasciidigit(str[0]), so it is not an invariant. Short\u2011circuit evaluation also prevents dereferencing str when it is NULL."
}