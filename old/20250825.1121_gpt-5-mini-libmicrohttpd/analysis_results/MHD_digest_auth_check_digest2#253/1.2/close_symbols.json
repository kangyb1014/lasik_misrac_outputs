{
  "user_message": "Target function code is:\n```c\n_MHD_EXTERN int\nMHD_digest_auth_check_digest2 (struct MHD_Connection *connection,\n                               const char *realm,\n                               const char *username,\n                               const uint8_t *digest,\n                               size_t digest_size,\n                               unsigned int nonce_timeout,\n                               enum MHD_DigestAuthAlgorithm algo)\n{\n  enum MHD_DigestAuthResult res;\n  enum MHD_DigestAuthMultiAlgo3 malgo3;\n\n  if (MHD_DIGEST_ALG_AUTO == algo)\n    malgo3 = MHD_DIGEST_AUTH_MULT_ALGO3_ANY_NON_SESSION;\n  else if (MHD_DIGEST_ALG_MD5 == algo)\n    malgo3 = MHD_DIGEST_AUTH_MULT_ALGO3_MD5;\n  else if (MHD_DIGEST_ALG_SHA256 == algo)\n    malgo3 = MHD_DIGEST_AUTH_MULT_ALGO3_SHA256;\n  else\n    MHD_PANIC (_ (\"Wrong 'algo' value, API violation\"));\n\n  res = MHD_digest_auth_check_digest3 (connection,\n                                       realm,\n                                       username,\n                                       digest,\n                                       digest_size,\n                                       nonce_timeout,\n                                       0, MHD_DIGEST_AUTH_MULT_QOP_AUTH,\n                                       malgo3);\n  if (MHD_DAUTH_OK == res)\n    return MHD_YES;\n  else if ((MHD_DAUTH_NONCE_STALE == res) || (MHD_DAUTH_NONCE_WRONG == res) ||\n           (MHD_DAUTH_NONCE_OTHER_COND == res) )\n    return MHD_INVALID_NONCE;\n  return MHD_NO;\n}\n```\n\nStatic call graph of the target function is:\n```json\n{'MHD_digest_auth_check_digest2': {'callees': ['__builtin_unreachable', 'MHD_digest_auth_check_digest3'], 'callers': ['MHD_digest_auth_check_digest']}, '__builtin_unreachable': {'callees': [], 'callers': ['try_ready_normal_body', 'try_ready_chunked_body', 'process_request_body', 'MHD_update_last_activity_', 'MHD_connection_handle_write', 'cleanup_connection', 'MHD_connection_handle_idle', 'MHD_set_connection_option', 'MHD_ip_count_lock', 'MHD_ip_count_unlock', 'MHD_ip_limit_del', 'new_connection_prepare_', 'new_connection_close_', 'new_connection_process_', 'internal_add_connection', 'new_connections_list_process_', 'internal_suspend_connection_', 'MHD_suspend_connection', 'MHD_resume_connection', 'MHD_upgraded_connection_mark_app_closed_', 'resume_suspended_connections', 'MHD_add_connection', 'MHD_accept_connection', 'MHD_cleanup_connections', 'MHD_epoll', 'close_connection', 'MHD_quiesce_daemon', 'MHD_start_daemon_va', 'close_all_connections', 'MHD_stop_daemon', 'MHD_create_response_from_iovec', 'MHD_destroy_response', 'MHD_increment_response_rc', 'MHD_create_post_processor', 'post_process_urlencoded', 'post_process_multipart', 'check_nonce_nc', 'calculate_add_nonce', 'digest_auth_check_all_inner', 'MHD_digest_auth_check_digest3', 'MHD_digest_auth_check2', 'MHD_digest_auth_check_digest2', 'queue_auth_required_response3_inner', 'MHD_queue_auth_fail_response2']}, 'MHD_digest_auth_check_digest3': {'callees': ['__builtin_unreachable', 'digest_get_hash_size', 'digest_auth_check_all'], 'callers': ['MHD_digest_auth_check_digest2', 'handle_sec_areas_req']}, 'MHD_digest_auth_check_digest': {'callees': ['MHD_digest_auth_check_digest2'], 'callers': []}}\n```\n\n\nList additional symbols that are required to analyze the target function to determine if the target function code violates the following MISRA C rule:\nLanguage extensions should not be used. You should report only when the code uses any language compiler extensions that are explicitly stated as an extension in compiler documentations.\nThe list will be included in the prompt for the next agent, so be concise and clear.\nExplain why each symbol is required in the analysis of the target function for the MISRA C rule.\n",
  "close_symbols": [
    "_MHD_EXTERN",
    "MHD_PANIC",
    "_",
    "MHD_digest_auth_check_digest3",
    "__builtin_unreachable",
    "struct MHD_Connection",
    "enum MHD_DigestAuthAlgorithm",
    "MHD_DIGEST_ALG_AUTO",
    "MHD_DIGEST_ALG_MD5",
    "MHD_DIGEST_ALG_SHA256",
    "enum MHD_DigestAuthResult",
    "MHD_DAUTH_OK",
    "MHD_DAUTH_NONCE_STALE",
    "MHD_DAUTH_NONCE_WRONG",
    "MHD_DAUTH_NONCE_OTHER_COND",
    "enum MHD_DigestAuthMultiAlgo3",
    "MHD_DIGEST_AUTH_MULT_ALGO3_ANY_NON_SESSION",
    "MHD_DIGEST_AUTH_MULT_ALGO3_MD5",
    "MHD_DIGEST_AUTH_MULT_ALGO3_SHA256",
    "MHD_YES",
    "MHD_NO",
    "MHD_INVALID_NONCE"
  ],
  "explanation": "To determine whether the target function uses compiler/language extensions you must inspect the definitions and declarations that could expand to or carry compiler-specific constructs. Specifically:\n\n- _MHD_EXTERN: Macro controlling linkage/visibility may expand to compiler-specific attributes (e.g. __attribute__, __declspec). Inspect its definition for extensions.\n- MHD_PANIC: Likely a macro that may use compiler built-ins (e.g. __builtin_trap, __builtin_unreachable) or noreturn attributes. Its expansion must be checked.\n- _: The translation/macro wrapper (often gettext) could be implemented as a macro or function with non\u2011standard behavior; inspect for extensions.\n- MHD_digest_auth_check_digest3: The callee\u2019s declaration/definition may carry gcc/clang attributes (nonnull, returns_nonnull, format, visibility, etc.) or use builtins; check it.\n- __builtin_unreachable: A known compiler builtin (GCC/Clang extension). It appears in the call graph; determine if any macro/decl in this function expands to it.\n- struct MHD_Connection: Its definition could include compiler extensions (packed, aligned, transparent_union, etc.); inspect the type.\n- enum MHD_DigestAuthAlgorithm: The enum declaration may use extensions (explicit underlying type, attributes). You must inspect it to see if non\u2011standard enum features are used.\n- MHD_DIGEST_ALG_AUTO, MHD_DIGEST_ALG_MD5, MHD_DIGEST_ALG_SHA256: These constants/macros may be defined using non\u2011standard constructs; check their definitions.\n- enum MHD_DigestAuthResult and related constants (MHD_DAUTH_OK, MHD_DAUTH_NONCE_STALE, MHD_DAUTH_NONCE_WRONG, MHD_DAUTH_NONCE_OTHER_COND): Enum or macro definitions could use extensions; inspect for attributes or nonstandard integer widths.\n- enum MHD_DigestAuthMultiAlgo3 and its values (MHD_DIGEST_AUTH_MULT_ALGO3_ANY_NON_SESSION, MHD_DIGEST_AUTH_MULT_ALGO3_MD5, MHD_DIGEST_AUTH_MULT_ALGO3_SHA256): These may be defined with attributes or macro tricks; check for extensions.\n- MHD_YES, MHD_NO, MHD_INVALID_NONCE: These return/value macros could be defined using compiler-specific constructs; inspect definitions.\n\nIn short: check all macros, type and function declarations referenced by the target function (storage-class macros, panic/diagnostic macros, callee declarations, enums and constants, and the connection type) for use of compiler built-ins or attribute syntax that are explicit language/compiler extensions."
}