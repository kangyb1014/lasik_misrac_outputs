{
  "user_message": "An agent A claimed that the following MHD_str_has_token_caseless_ code violates the MISRA C 2023 rule 17.8.\n<misra_rule>\nMISRA C 2023 Rule 17.8 is A function parameter should not be modified.\nNote that the object referred to by a pointer parameter may be modified, but the pointer itself shall not be modified.\n</misra_rule>\n<target_code>\nHere is the original code of MHD_str_has_token_caseless_.\n```c\nbool\nMHD_str_has_token_caseless_ (const char *str,\n                             const char *const token,\n                             size_t token_len)\n{\n  if (0 == token_len)\n    return false;\n\n  while (0 != *str)\n  {\n    size_t i;\n    /* Skip all whitespaces and empty tokens. */\n    while (' ' == *str || '\\t' == *str || ',' == *str)\n      str++;\n\n    /* Check for token match. */\n    i = 0;\n    while (1)\n    {\n      const char sc = *(str++);\n      const char tc = token[i++];\n\n      if (0 == sc)\n        return false;\n      if (! charsequalcaseless (sc, tc))\n        break;\n      if (i >= token_len)\n      {\n        /* Check whether substring match token fully or\n         * has additional unmatched chars at tail. */\n        while (' ' == *str || '\\t' == *str)\n          str++;\n        /* End of (sub)string? */\n        if ((0 == *str) || (',' == *str) )\n          return true;\n        /* Unmatched chars at end of substring. */\n        break;\n      }\n    }\n    /* Find next substring. */\n    while (0 != *str && ',' != *str)\n      str++;\n  }\n  return false;\n}\n```\n</target_code>\n<response format>\nProvide your answer with these fields.\n- explanation: your evaluation of the scenario provided by the agent A.\n- is_report_correct: whether the report is correct or not (true/false). True means there is a violation.\n</response format>\n<scenario>\nThe agent A provided the following violation scenario:\nThe function parameter 'str' (declared as const char *str) is incremented (modified) in the code fragment \u2014 e.g. while (' ' == *str || '\\t' == *str) str++; (and also via const char sc = *(str++); earlier). Modifying the pointer parameter itself violates MISRA C 2023 Rule 17.8 which prohibits changing pointer parameters (the object pointed to may be modified, but not the pointer).\n</scenario>\n<additional code>Here are the definitions of symbols that are close to the target function MHD_str_has_token_caseless_:\n_MHD_static_inline bool\ncharsequalcaseless (const char c1, const char c2)\n{\n  return ( (c1 == c2) ||\n           (isasciiupper (c1) ?\n            ((c1 - 'A' + 'a') == c2) :\n            ((c1 == (c2 - 'A' + 'a')) && isasciiupper (c2))) );\n}\n...\n_MHD_static_inline bool\nisasciiupper (char c)\n{\n  return (c >= 'A') && (c <= 'Z');\n}\n</additional code>\n\n<instruction>\nJudge whether the report is correct or not.\n</instruction>\n",
  "is_report_correct": true,
  "explanation": "Agent A is correct. MISRA C:2023 Rule 17.8 states a function parameter shall not be modified; while the object referred to by a pointer parameter may be modified, the pointer itself shall not be changed. In the function MHD_str_has_token_caseless_ the parameter 'str' has type 'const char *' (pointer to const char) but the pointer variable 'str' is incremented in multiple places (e.g. while (' ' == *str || '\\t' == *str) str++; and const char sc = *(str++);). Those operations modify the pointer parameter itself and therefore violate Rule 17.8. (By contrast 'token' is declared 'const char * const token' so its pointer is const and not modified.) A compliant fix is to use a local pointer copy (e.g. const char *p = str;) and operate on p instead of modifying the parameter.)"
}