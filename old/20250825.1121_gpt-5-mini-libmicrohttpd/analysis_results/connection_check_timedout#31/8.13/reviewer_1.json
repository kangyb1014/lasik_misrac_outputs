{
  "user_message": "An agent A claimed that the following connection_check_timedout code violates the MISRA C 2023 rule 8.13.\n<misra_rule>\nMISRA C 2023 Rule 8.13 is A pointer should point to a const-qualified type whenever possible.\n\n</misra_rule>\n<target_code>\nHere is the original code of connection_check_timedout.\n```c\nstatic bool\nconnection_check_timedout (struct MHD_Connection *c)\n{\n  const uint64_t timeout = c->connection_timeout_ms;\n  uint64_t now;\n  uint64_t since_actv;\n\n  if (c->suspended)\n    return false;\n  if (0 == timeout)\n    return false;\n  now = MHD_monotonic_msec_counter ();\n  since_actv = now - c->last_activity;\n  /* Keep the next lines in sync with #connection_get_wait() to avoid\n   * undesired side-effects like busy-waiting. */\n  if (timeout < since_actv)\n  {\n    if (UINT64_MAX / 2 < since_actv)\n    {\n      const uint64_t jump_back = c->last_activity - now;\n      /* Very unlikely that it is more than quarter-million years pause.\n       * More likely that system clock jumps back. */\n      if (5000 >= jump_back)\n      {\n#ifdef HAVE_MESSAGES\n        MHD_DLOG (c->daemon,\n                  _ (\"Detected system clock %u milliseconds jump back.\\n\"),\n                  (unsigned int) jump_back);\n#endif\n        return false;\n      }\n#ifdef HAVE_MESSAGES\n      MHD_DLOG (c->daemon,\n                _ (\"Detected too large system clock %\" PRIu64 \" milliseconds \"\n                   \"jump back.\\n\"),\n                jump_back);\n#endif\n    }\n    return true;\n  }\n  return false;\n}\n```\n</target_code>\n<response format>\nProvide your answer with these fields.\n- explanation: your evaluation of the scenario provided by the agent A.\n- is_report_correct: whether the report is correct or not (true/false). True means there is a violation.\n</response format>\n<scenario>\nThe agent A provided the following violation scenario:\nThe function parameter is declared as 'struct MHD_Connection *c' even though the function only reads fields from the pointed object (connection_timeout_ms, suspended, last_activity, daemon) and performs no modifications. According to MISRA C 2023 Rule 8.13 the pointer should be to a const-qualified type when possible. The signature should be changed to 'const struct MHD_Connection *c' (unless some called macros/functions like MHD_DLOG require a non-const pointer), so as written this violates Rule 8.13.\n</scenario>\n\n<instruction>\nJudge whether the report is correct or not.\n</instruction>\n",
  "is_report_correct": true,
  "explanation": "Correct. Rule 8.13 requires pointers to be const\u2011qualified when the pointed\u2011to object is not modified. The static function connection_check_timedout only reads members of *c (connection_timeout_ms, suspended, last_activity, daemon) and performs no writes to the pointed object; therefore the parameter could and should be declared as const struct MHD_Connection *c. The uses inside (including passing c->daemon to MHD_DLOG) do not require a non\u2011const pointer to the connection object itself, so there is no obstacle to adding const. Because the code fails to qualify the pointer as const where possible, the report of a Rule 8.13 violation is correct."
}