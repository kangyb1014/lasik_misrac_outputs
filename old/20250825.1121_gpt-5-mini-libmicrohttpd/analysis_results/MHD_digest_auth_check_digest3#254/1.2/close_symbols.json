{
  "user_message": "Target function code is:\n```c\n_MHD_EXTERN enum MHD_DigestAuthResult\nMHD_digest_auth_check_digest3 (struct MHD_Connection *connection,\n                               const char *realm,\n                               const char *username,\n                               const void *userdigest,\n                               size_t userdigest_size,\n                               unsigned int nonce_timeout,\n                               uint32_t max_nc,\n                               enum MHD_DigestAuthMultiQOP mqop,\n                               enum MHD_DigestAuthMultiAlgo3 malgo3)\n{\n  if (1 != (((0 != (malgo3 & MHD_DIGEST_BASE_ALGO_MD5)) ? 1 : 0)\n            + ((0 != (malgo3 & MHD_DIGEST_BASE_ALGO_SHA256)) ? 1 : 0)\n            + ((0 != (malgo3 & MHD_DIGEST_BASE_ALGO_SHA512_256)) ? 1 : 0)))\n    MHD_PANIC (_ (\"Wrong 'malgo3' value, only one base hashing algorithm \" \\\n                  \"(MD5, SHA-256 or SHA-512/256) must be specified, \" \\\n                  \"API violation\"));\n\n#ifndef MHD_MD5_SUPPORT\n  if (0 != (((unsigned int) malgo3) & MHD_DIGEST_BASE_ALGO_MD5))\n  {\n#ifdef HAVE_MESSAGES\n    MHD_DLOG (connection->daemon,\n              _ (\"The MD5 algorithm is not supported by this MHD build.\\n\"));\n#endif /* HAVE_MESSAGES */\n    return MHD_DAUTH_WRONG_ALGO;\n  }\n#endif /* ! MHD_MD5_SUPPORT */\n#ifndef MHD_SHA256_SUPPORT\n  if (0 != (((unsigned int) malgo3) & MHD_DIGEST_BASE_ALGO_SHA256))\n  {\n#ifdef HAVE_MESSAGES\n    MHD_DLOG (connection->daemon,\n              _ (\"The SHA-256 algorithm is not supported by \"\n                 \"this MHD build.\\n\"));\n#endif /* HAVE_MESSAGES */\n    return MHD_DAUTH_WRONG_ALGO;\n  }\n#endif /* ! MHD_SHA256_SUPPORT */\n#ifndef MHD_SHA512_256_SUPPORT\n  if (0 != (((unsigned int) malgo3) & MHD_DIGEST_BASE_ALGO_SHA512_256))\n  {\n#ifdef HAVE_MESSAGES\n    MHD_DLOG (connection->daemon,\n              _ (\"The SHA-512/256 algorithm is not supported by \"\n                 \"this MHD build.\\n\"));\n#endif /* HAVE_MESSAGES */\n    return MHD_DAUTH_WRONG_ALGO;\n  }\n#endif /* ! MHD_SHA512_256_SUPPORT */\n\n  if (digest_get_hash_size ((enum MHD_DigestAuthAlgo3) malgo3) !=\n      userdigest_size)\n    MHD_PANIC (_ (\"Wrong 'userdigest_size' value, does not match 'malgo3', \"\n                  \"API violation\"));\n\n  return digest_auth_check_all (connection,\n                                realm,\n                                username,\n                                NULL,\n                                (const uint8_t *) userdigest,\n                                nonce_timeout,\n                                max_nc,\n                                mqop,\n                                malgo3);\n}\n```\n\nStatic call graph of the target function is:\n```json\n{'MHD_digest_auth_check_digest3': {'callees': ['__builtin_unreachable', 'digest_get_hash_size', 'digest_auth_check_all'], 'callers': ['MHD_digest_auth_check_digest2', 'handle_sec_areas_req']}, '__builtin_unreachable': {'callees': [], 'callers': ['try_ready_normal_body', 'try_ready_chunked_body', 'process_request_body', 'MHD_update_last_activity_', 'MHD_connection_handle_write', 'cleanup_connection', 'MHD_connection_handle_idle', 'MHD_set_connection_option', 'MHD_ip_count_lock', 'MHD_ip_count_unlock', 'MHD_ip_limit_del', 'new_connection_prepare_', 'new_connection_close_', 'new_connection_process_', 'internal_add_connection', 'new_connections_list_process_', 'internal_suspend_connection_', 'MHD_suspend_connection', 'MHD_resume_connection', 'MHD_upgraded_connection_mark_app_closed_', 'resume_suspended_connections', 'MHD_add_connection', 'MHD_accept_connection', 'MHD_cleanup_connections', 'MHD_epoll', 'close_connection', 'MHD_quiesce_daemon', 'MHD_start_daemon_va', 'close_all_connections', 'MHD_stop_daemon', 'MHD_create_response_from_iovec', 'MHD_destroy_response', 'MHD_increment_response_rc', 'MHD_create_post_processor', 'post_process_urlencoded', 'post_process_multipart', 'check_nonce_nc', 'calculate_add_nonce', 'digest_auth_check_all_inner', 'MHD_digest_auth_check_digest3', 'MHD_digest_auth_check2', 'MHD_digest_auth_check_digest2', 'queue_auth_required_response3_inner', 'MHD_queue_auth_fail_response2']}, 'digest_get_hash_size': {'callees': [], 'callers': ['MHD_digest_get_hash_size', 'MHD_digest_auth_calc_userhash_hex', 'MHD_digest_auth_check_digest3']}, 'digest_auth_check_all': {'callees': ['digest_auth_check_all_inner'], 'callers': ['MHD_digest_auth_check3', 'MHD_digest_auth_check_digest3']}, 'MHD_digest_auth_check_digest2': {'callees': ['__builtin_unreachable', 'MHD_digest_auth_check_digest3'], 'callers': ['MHD_digest_auth_check_digest']}, 'handle_sec_areas_req': {'callees': ['MHD_digest_auth_get_username3', 'reply_with_auth_required', 'find_entry_by_userinfo', 'MHD_digest_auth_check_digest3', 'get_m_QOP', 'reply_with_area1_pages', 'reply_with_forbidden', 'reply_with_area2_pages'], 'callers': ['ahc_main']}}\n```\n\n\nList additional symbols that are required to analyze the target function to determine if the target function code violates the following MISRA C rule:\nLanguage extensions should not be used. You should report only when the code uses any language compiler extensions that are explicitly stated as an extension in compiler documentations.\nThe list will be included in the prompt for the next agent, so be concise and clear.\nExplain why each symbol is required in the analysis of the target function for the MISRA C rule.\n",
  "close_symbols": [
    "MHD_PANIC",
    "_MHD_EXTERN",
    "MHD_DLOG",
    "_ (gettext macro)",
    "__builtin_unreachable",
    "MHD_DIGEST_BASE_ALGO_MD5",
    "MHD_DIGEST_BASE_ALGO_SHA256",
    "MHD_DIGEST_BASE_ALGO_SHA512_256",
    "MHD_MD5_SUPPORT",
    "MHD_SHA256_SUPPORT",
    "MHD_SHA512_256_SUPPORT",
    "digest_get_hash_size (declaration/definition)",
    "digest_auth_check_all (declaration/definition)",
    "struct MHD_Connection (definition)",
    "enum MHD_DigestAuthAlgo3 (definition)"
  ],
  "explanation": "You must inspect any macro or symbol whose expansion or definition could introduce compiler-specific language extensions (attributes, compiler builtins, intrinsics, non-standard keywords, or special calling/visibility annotations). For this function the likely sources are: \n\n- MHD_PANIC: used directly in the function and very likely a macro that expands to logging + abort/exit helpers; such macros often use compiler extensions (e.g. __attribute__((noreturn)), __builtin_unreachable, abort builtins). Inspect its definition to detect any use of compiler-specific extensions.\n\n- _MHD_EXTERN: controls linkage/visibility of the function; it commonly expands to compiler-specific storage-class/visibility attributes (e.g. __attribute__((visibility(...))) or __declspec(...)). Its expansion must be checked for extensions.\n\n- MHD_DLOG: logging macro used under HAVE_MESSAGES; logging macros frequently use variadic macros, format attributes, or compiler builtins. Check its definition for extensions.\n\n- _ (gettext macro): the localization macro may be a wrapper or macro that could use compiler-specific constructs; verify its definition.\n\n- __builtin_unreachable: appears in the static call graph as a callee (likely via MHD_PANIC or other macros). This is a GCC/Clang builtin (a language extension). Its presence directly constitutes use of a compiler extension and must be confirmed.\n\n- MHD_DIGEST_BASE_ALGO_MD5, MHD_DIGEST_BASE_ALGO_SHA256, MHD_DIGEST_BASE_ALGO_SHA512_256: these macros/constants are used in bitwise tests and are usually integer macros. Their definitions should be checked in case they are defined using non-standard constructs (e.g. GCC binary literal extensions or computed via extension macros).\n\n- MHD_MD5_SUPPORT, MHD_SHA256_SUPPORT, MHD_SHA512_256_SUPPORT: feature-test macros control conditional compilation. To determine whether extension-using code paths can be compiled into this function you must know their values/definitions (or how they are set) so you can inspect the active macro expansions.\n\n- digest_get_hash_size (declaration/definition): called by the function. Its prototype/definition could include compiler-specific attributes (e.g. attribute((const)), format, visibility) or use builtins; inspect it to ensure no extensions are introduced via the call or return type.\n\n- digest_auth_check_all (declaration/definition): same rationale as digest_get_hash_size \u2014 the callee's prototype or inlined implementation could bring in attributes or builtins.\n\n- struct MHD_Connection (definition): the function accesses connection->daemon inside macros (e.g. MHD_DLOG). The type of daemon or struct layout could use compiler extensions (bitfields with non-standard widths, pragma-packed attributes, or compiler-specific attributes). Inspect the struct and member types used by macros.\n\n- enum MHD_DigestAuthAlgo3 (definition): the code casts malgo3 to unsigned/int and to enum MHD_DigestAuthAlgo3; check the enum definition to ensure no compiler-specific enumerator extensions are used.\n\nInspecting these symbols and their definitions/expansions will reveal any use of compiler-specific language extensions (builtins, __attribute__, compiler intrinsics, non-standard keywords). Only after verifying these definitions can you conclude whether the target function violates the MISRA rule about language extensions."
}