{
  "user_message": "An agent A claimed that the following try_match_header code violates the MISRA C 2023 rule 8.13.\n<misra_rule>\nMISRA C 2023 Rule 8.13 is A pointer should point to a const-qualified type whenever possible.\n\n</misra_rule>\n<target_code>\nHere is the original code of try_match_header.\n```c\nstatic int\ntry_match_header (const char *prefix,\n                  size_t prefix_len,\n                  char *line,\n                  char **suffix)\n{\n  if (NULL != *suffix)\n    return MHD_NO;\n  while (0 != *line)\n  {\n    if (MHD_str_equal_caseless_n_ (prefix,\n                                   line,\n                                   prefix_len))\n    {\n      *suffix = strdup (&line[prefix_len]);\n      return MHD_YES;\n    }\n    ++line;\n  }\n  return MHD_NO;\n}\n```\n</target_code>\n<response format>\nProvide your answer with these fields.\n- explanation: your evaluation of the scenario provided by the agent A.\n- is_report_correct: whether the report is correct or not (true/false). True means there is a violation.\n</response format>\n<scenario>\nThe agent A provided the following violation scenario:\nThe parameter 'line' is declared as 'char *' but the code does not modify the characters it points to \u2014 it only reads them (checks *line and calls MHD_str_equal_caseless_n_) and advances the pointer with '++line'. According to MISRA C 2023 Rule 8.13, the pointer should be to a const-qualified type when possible. 'line' should be 'const char *line' (incrementing the pointer is still allowed), so the current use of 'char *line' violates the rule.\n</scenario>\n\n<instruction>\nJudge whether the report is correct or not.\n</instruction>\n",
  "is_report_correct": true,
  "explanation": "The report is correct. Rule 8.13 requires using a const-qualified pointee type whenever the function does not modify the object pointed to. In try_match_header the function never modifies the characters in the buffer pointed to by line \u2014 it only reads *line, calls a comparison routine and advances the local pointer (++line). Advancing the pointer does not require the pointee to be non-const. The call to strdup(&line[prefix_len]) also treats the argument as input. Therefore line should be declared const char *line to comply with MISRA C:2023 Rule 8.13.\n\nMinor caveat: if MHD_str_equal_caseless_n_ has a non-const parameter type (e.g. char *) or callers rely on try_match_header accepting only char *, changing the prototype to const char * could require adjusting those declarations or adding casts. But that is an interoperability issue, not a justification for violating the rule. Overall the agent A finding is correct."
}