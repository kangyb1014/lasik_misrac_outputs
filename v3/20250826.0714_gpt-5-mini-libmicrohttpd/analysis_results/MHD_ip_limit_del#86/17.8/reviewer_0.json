{
  "user_message": "An agent A claimed that the following MHD_ip_limit_del code violates the MISRA C 2023 rule 17.8.\n<misra_rule>\nMISRA C 2023 Rule 17.8 is A function parameter should not be modified.\nNote that the object referred to by a pointer parameter may be modified, but the pointer itself shall not be modified.\n</misra_rule>\n<target_code>\nHere is the original code of MHD_ip_limit_del.\n```c\nstatic void\nMHD_ip_limit_del (struct MHD_Daemon *daemon,\n                  const struct sockaddr_storage *addr,\n                  socklen_t addrlen)\n{\n  struct MHD_IPCount search_key;\n  struct MHD_IPCount *found_key;\n  void **nodep;\n\n  daemon = MHD_get_master (daemon);\n  /* Ignore if no connection limit assigned */\n  if (0 == daemon->per_ip_connection_limit)\n    return;\n  /* Initialize search key */\n  if (MHD_NO == MHD_ip_addr_to_key (addr,\n                                    addrlen,\n                                    &search_key))\n    return;\n\n  MHD_ip_count_lock (daemon);\n\n  /* Search for the IP address */\n  if (NULL == (nodep = tfind (&search_key,\n                              &daemon->per_ip_connection_count,\n                              &MHD_ip_addr_compare)))\n  {\n    /* Something's wrong if we couldn't find an IP address\n     * that was previously added */\n    MHD_PANIC (_ (\"Failed to find previously-added IP address.\\n\"));\n  }\n  found_key = (struct MHD_IPCount *) *nodep;\n  /* Validate existing count for IP address */\n  if (0 == found_key->count)\n  {\n    MHD_PANIC (_ (\"Previously-added IP address had counter of zero.\\n\"));\n  }\n  /* Remove the node entirely if count reduces to 0 */\n  if (0 == --found_key->count)\n  {\n    tdelete (found_key,\n             &daemon->per_ip_connection_count,\n             &MHD_ip_addr_compare);\n    MHD_ip_count_unlock (daemon);\n    free (found_key);\n  }\n  else\n    MHD_ip_count_unlock (daemon);\n}\n```\n</target_code>\n<response format>\nProvide your answer with these fields.\n- explanation: your evaluation of the scenario provided by the agent A.\n- is_report_correct: whether the report is correct or not (true/false). True means there is a violation.\n</response format>\n<scenario>\nThe agent A provided the following violation scenario:\nThe statement 'daemon = MHD_get_master(daemon);' reassigns the function parameter 'daemon', thereby modifying the pointer parameter itself. MISRA C 2023 Rule 17.8 forbids modifying function parameters (the object pointed to may be modified, but not the pointer parameter). To conform, the code should use a local variable, e.g. 'struct MHD_Daemon *master = MHD_get_master(daemon);' and use 'master' thereafter.\n</scenario>\n\n<execution_log>\nThe agent A also provided the following output log:\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x5628cb7378d0, addr=0x5628cb738430, addrlen=16\n2025-08-26 07:57:40 - after MHD_get_master: daemon=0x5628cb7378d0\n2025-08-26 07:57:40 - per_ip_connection_limit=0\n2025-08-26 07:57:40 - exiting: no per-IP connection limit assigned\n2025-08-26 07:57:40 - enter MHD_ip_limit_del: daemon param=0x562\n</execution_log>\n\n<instruction>\nJudge whether the report is correct or not.\n</instruction>\n",
  "is_report_correct": true,
  "explanation": "Correct. MISRA C 2023 Rule 17.8 states that a function parameter shall not be modified; for pointer parameters the pointed-to object may be modified but the pointer itself must not be reassigned. The statement\n  daemon = MHD_get_master(daemon);\nreassigns the pointer parameter 'daemon', which violates Rule 17.8. The recommended fix is to introduce a local variable, e.g. 'struct MHD_Daemon *master = MHD_get_master(daemon);' and use 'master' for subsequent accesses instead of reassigning the parameter."
}