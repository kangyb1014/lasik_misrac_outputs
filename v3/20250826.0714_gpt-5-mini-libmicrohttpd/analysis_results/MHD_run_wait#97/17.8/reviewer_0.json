{
  "user_message": "An agent A claimed that the following MHD_run_wait code violates the MISRA C 2023 rule 17.8.\n<misra_rule>\nMISRA C 2023 Rule 17.8 is A function parameter should not be modified.\nNote that the object referred to by a pointer parameter may be modified, but the pointer itself shall not be modified.\n</misra_rule>\n<target_code>\nHere is the original code of MHD_run_wait.\n```c\n_MHD_EXTERN enum MHD_Result\nMHD_run_wait (struct MHD_Daemon *daemon,\n              int32_t millisec)\n{\n  enum MHD_Result res;\n  if ( (daemon->shutdown) ||\n       MHD_D_IS_USING_THREADS_ (daemon) )\n    return MHD_NO;\n\n  mhd_assert (! MHD_thread_handle_ID_is_valid_handle_ (daemon->tid));\n\n  if (0 > millisec)\n    millisec = -1;\n#ifdef HAVE_POLL\n  if (MHD_D_IS_USING_POLL_ (daemon))\n  {\n    res = MHD_poll_all (daemon, millisec);\n    MHD_cleanup_connections (daemon);\n  }\n  else\n#endif /* HAVE_POLL */\n#ifdef EPOLL_SUPPORT\n  if (MHD_D_IS_USING_EPOLL_ (daemon))\n  {\n    res = MHD_epoll (daemon, millisec);\n    MHD_cleanup_connections (daemon);\n  }\n  else\n#endif\n  if (1)\n  {\n    mhd_assert (MHD_D_IS_USING_SELECT_ (daemon));\n#ifdef HAS_FD_SETSIZE_OVERRIDABLE\n#ifdef HAVE_MESSAGES\n    if (daemon->fdset_size_set_by_app\n        && (((int) FD_SETSIZE) < daemon->fdset_size))\n    {\n      MHD_DLOG (daemon,\n                _ (\"MHD_run()/MHD_run_wait() called for daemon started with \" \\\n                   \"MHD_OPTION_APP_FD_SETSIZE option (%d). \" \\\n                   \"The library was compiled with smaller FD_SETSIZE (%d). \" \\\n                   \"Some socket FDs may be not processed. \" \\\n                   \"Use MHD_run_from_select2() instead of MHD_run() or \" \\\n                   \"do not use MHD_OPTION_APP_FD_SETSIZE option.\\n\"),\n                daemon->fdset_size, (int) FD_SETSIZE);\n    }\n#endif /* HAVE_MESSAGES */\n#endif /* HAS_FD_SETSIZE_OVERRIDABLE */\n\n    res = MHD_select (daemon, millisec);\n    /* MHD_select does MHD_cleanup_connections already */\n  }\n  return res;\n}\n```\n</target_code>\n<response format>\nProvide your answer with these fields.\n- explanation: your evaluation of the scenario provided by the agent A.\n- is_report_correct: whether the report is correct or not (true/false). True means there is a violation.\n</response format>\n<scenario>\nThe agent A provided the following violation scenario:\nThe code assigns to the non-pointer function parameter 'millisec' (millisec = -1;), i.e. it modifies a value parameter inside the function.\n</scenario>\n\n<execution_log>\nThe agent A also provided the following output log:\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb5de0 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb5de0 millisec=0 res=1\nreturn: daemon=0x55aec9bb5de0 millisec=0 res=1\nenter: daemon=0x55aec9bb6440 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb6440 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb6440 millisec=0 res=1\nreturn: daemon=0x55aec9bb6440 millisec=0 res=1\nenter: daemon=0x55aec9bb6440 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb6440 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb6440 millisec=0 res=1\nreturn: daemon=0x55aec9bb6440 millisec=0 res=1\nenter: daemon=0x55aec9bb6440 millisec=0 res=-1\nusing_select_before_call: daemon=0x55aec9bb6440 millisec=0 res=-1\nusing_select_after_call: daemon=0x55aec9bb6440 millisec=0 res=1\nreturn: daemon=0x55aec9bb6440 millisec=0 res=1\nenter: daemon=0x55aec9bb6440 millisec=0 res=-1\nusing_select_befo\n</execution_log>\n\n<instruction>\nJudge whether the report is correct or not.\n</instruction>\n",
  "is_report_correct": true,
  "explanation": "Agent A is correct. MISRA C 2023 Rule 17.8 states that a function parameter shall not be modified. In MHD_run_wait the non-pointer parameter millisec is assigned to (millisec = -1;), which is a direct modification of a function parameter and therefore violates Rule 17.8. The pointer parameter daemon is not the issue here. A compliant fix is to copy millisec to a local variable (e.g. timeout) and modify that instead."
}