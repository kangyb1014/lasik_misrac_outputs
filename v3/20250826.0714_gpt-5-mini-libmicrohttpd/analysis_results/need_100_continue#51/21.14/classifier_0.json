{
  "user_message": "<misra_rule>\nMISRA C 2023 Rule 21.14 is: The Standard Library function memcmp shall not be used to compare null terminated strings.\n\n</misra_rule>\n<response format>\nProvide your answer with these fields.\n- is_rule_violated: whether the rule is violated or not (true/false),\n- scenario: a specific violation scenario.\n</response format>\n<target_code>\nHere is the code of need_100_continue:\n```c\nstatic bool\nneed_100_continue (struct MHD_Connection *connection)\n{\n  const char *expect;\n\n  if (! MHD_IS_HTTP_VER_1_1_COMPAT (connection->rq.http_ver))\n    return false;\n\n  if (0 == connection->rq.remaining_upload_size)\n    return false;\n\n  if (MHD_NO ==\n      MHD_lookup_connection_value_n (connection,\n                                     MHD_HEADER_KIND,\n                                     MHD_HTTP_HEADER_EXPECT,\n                                     MHD_STATICSTR_LEN_ ( \\\n                                       MHD_HTTP_HEADER_EXPECT),\n                                     &expect,\n                                     NULL))\n    return false;\n\n  if (MHD_str_equal_caseless_ (expect,\n                               \"100-continue\"))\n    return true;\n\n  return false;\n}\n```\n</target_code>\n<target_code>\nHere is the code fragment that you need to analyze:\n```c\n  if (MHD_str_equal_caseless_ (expect,\n                               \"100-continue\"))\n    return true;\n```\nFocus on the above code fragment and judge whether it violates the rule 21.14 or not.\n</target_code>\n",
  "is_rule_violated": false,
  "scenario": "The fragment itself does not call the C library function memcmp; it calls a wrapper MHD_str_equal_caseless_. Therefore, based on the shown code alone, Rule 21.14 is not directly violated. A violation scenario would be if MHD_str_equal_caseless_ is implemented by calling memcmp to compare the null\u2011terminated string expect with the literal \"100-continue\" (for example using memcmp(expect, \"100-continue\", strlen(\"100-continue\")+1) or memcmp(expect, \"100-continue\", strlen(expect)+1)). In that case memcmp would be used to compare null\u2011terminated strings and Rule 21.14 would be violated."
}