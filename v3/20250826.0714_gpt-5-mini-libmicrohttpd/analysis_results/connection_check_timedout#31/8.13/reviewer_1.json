{
  "user_message": "An agent A claimed that the following connection_check_timedout code violates the MISRA C 2023 rule 8.13.\n<misra_rule>\nMISRA C 2023 Rule 8.13 is A pointer should point to a const-qualified type whenever possible.\n\n</misra_rule>\n<target_code>\nHere is the original code of connection_check_timedout.\n```c\nstatic bool\nconnection_check_timedout (struct MHD_Connection *c)\n{\n  const uint64_t timeout = c->connection_timeout_ms;\n  uint64_t now;\n  uint64_t since_actv;\n\n  if (c->suspended)\n    return false;\n  if (0 == timeout)\n    return false;\n  now = MHD_monotonic_msec_counter ();\n  since_actv = now - c->last_activity;\n  /* Keep the next lines in sync with #connection_get_wait() to avoid\n   * undesired side-effects like busy-waiting. */\n  if (timeout < since_actv)\n  {\n    if (UINT64_MAX / 2 < since_actv)\n    {\n      const uint64_t jump_back = c->last_activity - now;\n      /* Very unlikely that it is more than quarter-million years pause.\n       * More likely that system clock jumps back. */\n      if (5000 >= jump_back)\n      {\n#ifdef HAVE_MESSAGES\n        MHD_DLOG (c->daemon,\n                  _ (\"Detected system clock %u milliseconds jump back.\\n\"),\n                  (unsigned int) jump_back);\n#endif\n        return false;\n      }\n#ifdef HAVE_MESSAGES\n      MHD_DLOG (c->daemon,\n                _ (\"Detected too large system clock %\" PRIu64 \" milliseconds \"\n                   \"jump back.\\n\"),\n                jump_back);\n#endif\n    }\n    return true;\n  }\n  return false;\n}\n```\n</target_code>\n<response format>\nProvide your answer with these fields.\n- explanation: your evaluation of the scenario provided by the agent A.\n- is_report_correct: whether the report is correct or not (true/false). True means there is a violation.\n</response format>\n<scenario>\nThe agent A provided the following violation scenario:\nThe function takes a pointer parameter 'struct MHD_Connection *c' but only reads from the object (accesses c->suspended, c->connection_timeout_ms, c->last_activity and c->daemon) and never modifies *c. According to MISRA C 2023 Rule 8.13 the pointer should point to a const-qualified type when possible. The parameter should be declared as 'const struct MHD_Connection *c' (e.g. static bool connection_check_timedout(const struct MHD_Connection *c)).\n</scenario>\n\n<instruction>\nJudge whether the report is correct or not.\n</instruction>\n",
  "is_report_correct": true,
  "explanation": "The report is correct. The function only reads members of the pointed-to object (c->suspended, c->connection_timeout_ms, c->last_activity, c->daemon) and never modifies *c or any of its members, so per MISRA C 2023 Rule 8.13 the pointer parameter should be to a const-qualified type (e.g. static bool connection_check_timedout(const struct MHD_Connection *c)).\n\nNote: if the function must match an externally imposed non-const function-pointer signature (callback API) or is required by other code that depends on the non-const prototype, then changing the parameter would be incompatible and the deviation would need to be documented. Otherwise the prototype should be changed to take a pointer-to-const to comply with Rule 8.13."
}