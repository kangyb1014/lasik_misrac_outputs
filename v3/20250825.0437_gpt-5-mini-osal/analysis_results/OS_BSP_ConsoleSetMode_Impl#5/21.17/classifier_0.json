{
  "user_message": "<misra_rule>\nMISRA C 2023 Rule 21.17 is: Use of the string handling functions from <string.h> shall not result in accesses beyond the bounds of the objects referenced by their pointer parameters.\nThis rule strictly applies to the Standard Library functions in <string.h> such as memcpy, memmove, memset, memcmp, strcpy, strncpy, strcat, strncat, strlen, and strspn.\n</misra_rule>\n<response format>\nProvide your answer with these fields.\n- is_rule_violated: whether the rule is violated or not (true/false),\n- scenario: a specific violation scenario.\n</response format>\n<target_code>\nHere is the code of OS_BSP_ConsoleSetMode_Impl:\n```c\nvoid OS_BSP_ConsoleSetMode_Impl(uint32 ModeBits)\n{\n    char param[32];\n\n    if (OS_BSP_GenericLinuxGlobal.EnableTermControl)\n    {\n        if (ModeBits == OS_BSP_CONSOLEMODE_NORMAL)\n        {\n            OS_BSP_ExecTput(\"sgr0\", NULL);\n        }\n        else\n        {\n            if ((ModeBits & OS_BSP_CONSOLEMODE_HIGHLIGHT) == 0)\n            {\n                /* no highlight (standout) text */\n                OS_BSP_ExecTput(\"rmso\", NULL);\n            }\n            else\n            {\n                /* set highlight (standout) text */\n                OS_BSP_ExecTput(\"smso\", NULL);\n            }\n\n            snprintf(param, sizeof(param), \"%d\", OS_BSP_CONSOLEMODE_TO_ANSICOLOR(ModeBits));\n            OS_BSP_ExecTput(\"setaf\", param);\n        }\n    }\n}\n```\n</target_code>\n<target_code>\nHere is the code fragment that you need to analyze:\n```c\nOS_BSP_ExecTput(\"setaf\", param);\n```\nFocus on the above code fragment and judge whether it violates the rule 21.17 or not.\n</target_code>\n",
  "is_rule_violated": false,
  "scenario": "No direct use of <string.h> functions occurs in the shown fragment. The local buffer param is populated with snprintf(param, sizeof(param), \"%d\", ...), which guarantees NUL-termination when sizeof(param) > 0, and the 32-byte buffer is more than sufficient to hold the textual representation of an ANSI color index. Therefore this call to OS_BSP_ExecTput(\"setaf\", param) does not by itself violate MISRA C 2023 Rule 21.17.\n\nPotential violation scenario (specific): if OS_BSP_ExecTput internally uses a <string.h> function (e.g. strcpy, strcat, memcpy) to copy param into a smaller destination buffer without bounds checking, that internal copy could access beyond the destination bounds and would violate Rule 21.17. For example, if OS_BSP_ExecTput does strcpy(dest, param) where dest is smaller than the length of param, that would be a violation."
}