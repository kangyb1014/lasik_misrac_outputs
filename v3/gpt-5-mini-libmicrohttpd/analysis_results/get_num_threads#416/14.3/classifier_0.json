{
  "user_message": "<misra_rule>\nMISRA C 2023 Rule 14.3 is: Controlling expressions shall not be invariant.\nHere are exceptions to this rule:\n1. Invariants that are used to create infinite loops are permitted.\n2. A do-while loop with an essentially Boolean controlling expression that evaluates to false and satisfies the constraints and semantics for an integer constant expression is permitted.\n</misra_rule>\n<response format>\nProvide your answer with these fields.\n- is_rule_violated: whether the rule is violated or not (true/false),\n- scenario: a specific violation scenario.\n</response format>\n<target_code>\nHere is the code of get_num_threads:\n```c\nstatic unsigned int\nget_num_threads (void)\n{\n#if 0  /* disalbed code */\n  static const unsigned int max_threads = 32;\n#endif /* disalbed code */\n  if (0 < num_threads)\n    return num_threads;\n\n  num_threads = get_cpu_core_count () / 2;\n  if (0 == num_threads)\n    num_threads = 1;\n  else\n  {\n    unsigned int num_proc_cpus;\n    num_proc_cpus = get_process_cpu_core_count ();\n    if (num_proc_cpus >= num_threads)\n    {\n      printf (\"Using half of all available CPU cores, assuming the other half \"\n              \"is used by client / requests generator.\\n\");\n    }\n    else\n    {\n      printf (\"Using all CPU cores available for this process as more than \"\n              \"half of CPU cores on this system are still available for use \"\n              \"by client / requests generator.\\n\");\n      num_threads = num_proc_cpus;\n    }\n  }\n#if 0  /* disalbed code */\n  if (max_threads < num_threads)\n  {\n    printf (\"Number of threads are limited to %u as more threads \"\n            \"are unlikely to improve the performance.\\n\", max_threads);\n    num_threads = max_threads;\n  }\n#endif /* disalbed code */\n\n  return num_threads;\n}\n```\n</target_code>\n<target_code>\nHere is the code fragment that you need to analyze:\n```c\n#if 0  /* disalbed code */\n  if (max_threads < num_threads)\n  {\n    printf (\"Number of threads are limited to %u as more threads \"\n            \"are unlikely to improve the performance.\\n\", max_threads);\n    num_threads = max_threads;\n  }\n#endif /* disalbed code */\n```\nFocus on the above code fragment and judge whether it violates the rule 14.3 or not.\n</target_code>\n",
  "is_rule_violated": false,
  "scenario": "No violation. The if-statement fragment is inside a #if 0 / #endif block and therefore excluded from the translation unit (not a controlling expression in compiled code). Even if re-enabled, the condition (max_threads < num_threads) depends on num_threads and would not be an invariant constant expression unless the surrounding code made it permanently true/false, so Rule 14.3 is not violated here."
}