{
  "user_message": "An agent A claimed that the following pipe_reader code violates the MISRA C 2023 rule 8.13.\n<misra_rule>\nMISRA C 2023 Rule 8.13 is A pointer should point to a const-qualified type whenever possible.\n\n</misra_rule>\n<target_code>\nHere is the original code of pipe_reader.\n```c\nstatic ssize_t\npipe_reader (void *cls,\n             uint64_t pos,\n             char *buf,\n             size_t max)\n{\n  struct MHD_Response *response = cls;\n  ssize_t n;\n\n  (void) pos;\n\n#ifndef _WIN32\n  if (SSIZE_MAX < max)\n    max = SSIZE_MAX;\n  n = read (response->fd,\n            buf,\n            (MHD_SCKT_SEND_SIZE_) max);\n#else  /* _WIN32 */\n  if (UINT_MAX < max)\n    max = INT_MAX;\n  n = read (response->fd,\n            buf,\n            (unsigned int) max);\n#endif /* _WIN32 */\n\n  if (0 == n)\n    return MHD_CONTENT_READER_END_OF_STREAM;\n  if (n < 0)\n    return MHD_CONTENT_READER_END_WITH_ERROR;\n  return n;\n}\n```\n</target_code>\n<response format>\nProvide your answer with these fields.\n- explanation: your evaluation of the scenario provided by the agent A.\n- is_report_correct: whether the report is correct or not (true/false). True means there is a violation.\n</response format>\n<scenario>\nThe agent A provided the following violation scenario:\nViolation: the local pointer is declared as a non-const pointer but is only used for reading. The code does: \"struct MHD_Response *response = cls;\" yet the function only reads response->fd and does not modify the pointed object. Per MISRA C 2023 Rule 8.13 the pointer should be const-qualified \u2014 e.g. use \"const struct MHD_Response *response = cls;\" (or change the callback parameter to \"const void *cls\"), so the rule is violated.\n</scenario>\n\n<instruction>\nJudge whether the report is correct or not.\n</instruction>\n",
  "is_report_correct": true,
  "explanation": "The report is correct. The local pointer 'response' is declared as 'struct MHD_Response *' but in this function it is only read (response->fd) and never used to modify the pointed object. MISRA C 2023 Rule 8.13 requires that a pointer should point to a const-qualified type whenever possible, so the local declaration should be changed to const struct MHD_Response *response = cls; (or otherwise ensure const qualification is applied where appropriate). Changing the local variable to a pointer-to-const is allowed and does not require modifying the external callback signature (void *cls), so the current code violates the rule."
}