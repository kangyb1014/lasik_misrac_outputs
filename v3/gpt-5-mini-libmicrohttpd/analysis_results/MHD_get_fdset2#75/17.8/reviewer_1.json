{
  "user_message": "An agent A claimed that the following MHD_get_fdset2 code violates the MISRA C 2023 rule 17.8.\n<misra_rule>\nMISRA C 2023 Rule 17.8 is A function parameter should not be modified.\nNote that the object referred to by a pointer parameter may be modified, but the pointer itself shall not be modified.\n</misra_rule>\n<target_code>\nHere is the original code of MHD_get_fdset2.\n```c\n_MHD_EXTERN enum MHD_Result\nMHD_get_fdset2 (struct MHD_Daemon *daemon,\n                fd_set *read_fd_set,\n                fd_set *write_fd_set,\n                fd_set *except_fd_set,\n                MHD_socket *max_fd,\n                unsigned int fd_setsize)\n{\n  if ( (NULL == daemon) ||\n       (NULL == read_fd_set) ||\n       (NULL == write_fd_set) ||\n       MHD_D_IS_USING_THREADS_ (daemon) ||\n       MHD_D_IS_USING_POLL_ (daemon))\n    return MHD_NO;\n\n#ifdef HAVE_MESSAGES\n  if (NULL == except_fd_set)\n  {\n    MHD_DLOG (daemon,\n              _ (\"MHD_get_fdset2() called with except_fd_set \"\n                 \"set to NULL. Such behavior is unsupported.\\n\"));\n  }\n#endif\n\n#ifdef HAS_FD_SETSIZE_OVERRIDABLE\n  if (0 == fd_setsize)\n    return MHD_NO;\n  else if (((unsigned int) INT_MAX) < fd_setsize)\n    fd_setsize = (unsigned int) INT_MAX;\n#ifdef HAVE_MESSAGES\n  else if (daemon->fdset_size > ((int) fd_setsize))\n  {\n    if (daemon->fdset_size_set_by_app)\n    {\n      MHD_DLOG (daemon,\n                _ (\"%s() called with fd_setsize (%u) \" \\\n                   \"less than value set by MHD_OPTION_APP_FD_SETSIZE (%d). \" \\\n                   \"Some socket FDs may be not processed. \" \\\n                   \"Use MHD_OPTION_APP_FD_SETSIZE with the correct value.\\n\"),\n                \"MHD_get_fdset2\", fd_setsize, daemon->fdset_size);\n    }\n    else\n    {\n      MHD_DLOG (daemon,\n                _ (\"%s() called with fd_setsize (%u) \" \\\n                   \"less than FD_SETSIZE used by MHD (%d). \" \\\n                   \"Some socket FDs may be not processed. \" \\\n                   \"Consider using MHD_OPTION_APP_FD_SETSIZE option.\\n\"),\n                \"MHD_get_fdset2\", fd_setsize, daemon->fdset_size);\n    }\n  }\n#endif /* HAVE_MESSAGES */\n#else  /* ! HAS_FD_SETSIZE_OVERRIDABLE */\n  if (((unsigned int) FD_SETSIZE) > fd_setsize)\n  {\n#ifdef HAVE_MESSAGES\n    MHD_DLOG (daemon,\n              _ (\"%s() called with fd_setsize (%u) \" \\\n                 \"less than fixed FD_SETSIZE value (%d) used on the \" \\\n                 \"platform.\\n\"),\n              \"MHD_get_fdset2\", fd_setsize, (int) FD_SETSIZE);\n#endif /* HAVE_MESSAGES */\n    return MHD_NO;\n  }\n  fd_setsize = (int) FD_SETSIZE; /* Help compiler to optimise */\n#endif /* ! HAS_FD_SETSIZE_OVERRIDABLE */\n\n#ifdef EPOLL_SUPPORT\n  if (MHD_D_IS_USING_EPOLL_ (daemon))\n  {\n    if (daemon->shutdown)\n      return MHD_YES;\n\n    /* we're in epoll mode, use the epoll FD as a stand-in for\n       the entire event set */\n\n    return MHD_add_to_fd_set_ (daemon->epoll_fd,\n                               read_fd_set,\n                               max_fd,\n                               (int) fd_setsize) ? MHD_YES : MHD_NO;\n  }\n#endif\n\n  return internal_get_fdset2 (daemon,\n                              read_fd_set,\n                              write_fd_set,\n                              except_fd_set,\n                              max_fd,\n                              (int) fd_setsize);\n}\n```\n</target_code>\n<response format>\nProvide your answer with these fields.\n- explanation: your evaluation of the scenario provided by the agent A.\n- is_report_correct: whether the report is correct or not (true/false). True means there is a violation.\n</response format>\n<scenario>\nThe agent A provided the following violation scenario:\nThe assignment 'fd_setsize = (int) FD_SETSIZE;' writes to the value of the parameter fd_setsize (a non-pointer function parameter), thus modifying a function parameter and violating MISRA C 2023 Rule 17.8. Use a local variable (e.g., int local_fd_setsize = (int)FD_SETSIZE;) instead to avoid modifying the parameter.\n</scenario>\n\n<execution_log>\nThe agent A also provided the following output log:\nENTER MHD_get_fdset2: daemon=0x5618ef30bde0 read_fd_set=0x7ffdd6ad0880 write_fd_set=0x7ffdd6ad0880 except_fd_set=0x7ffdd6ad0880 max_fd=0x7ffdd6ad087c fd_setsize=1024\n!HAS_FD_SETSIZE_OVERRIDABLE: before assignment fd_setsize=1024, FD_SETSIZE=(int)1024\n!HAS_FD_SETSIZE_OVERRIDABLE: after assignment fd_setsize=1024 (was 1024) -- parameter was modified\nFINAL: calling internal_get_fdset2 with fd_setsize=(int)1024\nENTER MHD_get_fdset2: daemon=0x5618ef30bde0 read_fd_set=0x7ffdd6ad0880 write_fd_set=0x7ffdd6ad0880 except_fd_set=0x7ffdd6ad0880 max_fd=0x7ffdd6ad087c fd_setsize=1024\n!HAS_FD_SETSIZE_OVERRIDABLE: before assignment fd_setsize=1024, FD_SETSIZE=(int)1024\n!HAS_FD_SETSIZE_OVERRIDABLE: after assignment fd_setsize=1024 (was 1024) -- parameter was modified\nFINAL: calling internal_get_fdset2 with fd_setsize=(int)1024\nENTER MHD_get_fdset2: daemon=0x5618ef30bde0 read_fd_set=0x7ffdd6ad0880 write_fd_set=0x7ffdd6ad0880 except_fd_set=0x7ffdd6ad0880 max_fd=0x7ffdd6ad087c fd_setsize=1024\n!HAS_FD_SETSIZE_OVERRIDABLE: before assignment fd_setsize=1024, FD_SETSIZE=(int)1024\n!HAS_FD_SETSIZE_OVERRIDABLE: after assignment fd_setsize=1024 (was 1024) -- parameter was modified\nFINAL: calling internal_get_fdset2 with fd_setsize=(int)1024\nENTER MHD_get_fdset2: daemon=0x5618ef30bde0 read_fd_set=0x7ffdd6ad0880 write_fd_set=0x7ffdd6ad0880 except_fd_set=0x7ffdd6ad0880 max_fd=0x7ffdd6ad087c fd_setsize=1024\n!HAS_FD_SETSIZE_OVERRIDABLE: before assignment fd_setsize=1024, FD_SETSIZE=(int)1024\n!HAS_FD_SETSIZE_OVERRIDABLE: after assignment fd_setsize=1024 (was 1024) -- parameter was modified\nFINAL: calling internal_get_fdset2 with fd_setsize=(int)1024\nENTER MHD_get_fdset2: daemon=0x5618ef30bde0 read_fd_set=0x7ffdd6ad0880 write_fd_set=0x7ffdd6ad0880 except_fd_set=0x7ffdd6ad0880 max_fd=0x7ffdd6ad087c fd_setsize=1024\n!HAS_FD_SETSIZE_OVERRIDABLE: before assignment fd_setsize=1024, FD_SETSIZE=(int)1024\n!HAS_FD_SETSIZE_OVERRIDABLE: after assignment fd_setsize=1024 (was 1024) -- parameter was modified\nFINAL: calling internal_get_fdset2 with fd_setsize=(int)1024\nENTER MHD_get_fdset2: daemon=0x5618ef30bde0 read_fd_set=0x7ffdd6ad0880 write_fd_set=0x7ffdd6ad0880 except_fd_set=0x7ffdd6ad0880 max_fd=0x7ffdd6ad087c fd_setsize=1024\n!HAS_FD_SETSIZE_OVERRIDABLE: before assignment fd_setsize=1024, FD_SETSIZE=(int)1024\n!HAS_FD_SETSIZE_OVERRIDABLE: after assignment fd_setsize=1024 (was 1024) -- parameter was modified\nFINAL: calling internal_get_fdset2 with fd_setsize=(int)1024\nENTER MHD_get_fdset2: daemon=0x5618ef30bde0 read_fd_set=0x7ffdd6ad0880 write_fd_set=0x7ffdd6ad0880 except_fd_set=0x7ffdd6ad0880 max_fd=0x7ffdd6ad087c fd_setsize=1024\n!HAS_FD_SETSIZE_OVERRIDABLE: before assignment fd_setsize=1024, FD_SETSIZE=(int)1024\n!HAS_FD_SETSIZE_OVERRIDABLE: after assignment fd_setsize=1024 (was 1024) -- parameter was modified\nFINAL: calling internal_get_fdset2 with fd_setsize=(int)1024\nENTER MHD_get_fdset2: daemon=0x5618ef30bde0 read_fd_set=0x7ffdd6ad0880 write_fd_set=0x7ffdd6ad0880 except_fd_set=0x7ffdd6ad0880 max_fd=0x7ffdd6ad087c fd_setsize=1024\n!HAS_FD_SETSIZE_OVERRIDABLE: before assignment fd_setsize=1024, FD_SETSIZE=(int)1024\n!HAS_FD_SETSIZE_OVERRIDABLE: after assignment fd_setsize=1024 (was 1024) -- parameter was modified\nFINAL: calling internal_get_fdset2 with fd_setsize=(int)1024\nENTER MHD_get_fdset2: daemon=0x5618ef30bde0 read_fd_set=0x7ffdd6ad0880 write_fd_set=0x7ffdd6ad0880 except_fd_set=0x7ffdd6ad0880 max_fd=0x7ffdd6ad087c fd_setsize=1024\n!HAS_FD_SETSIZE_OVERRIDABLE: before assignment fd_setsize=1024, FD_SETSIZE=(int)1024\n!HAS_FD_SETSIZE_OVERRIDABLE: after assignment fd_setsize=1024 (was 1024) -- parameter was modified\nFINAL: calling internal_get_fdset2 with fd_setsize=(int)1024\nENTER MHD_get_fdset2: daemon=0x5618ef30bde0 read_fd_set=0x7ffdd6ad0880 write_fd_set=0x7ffdd6ad0880 except_fd_set=0x7ffdd6ad0880 max_fd=0x7ffdd6ad087c fd_setsize=1024\n!HAS_FD_SETSIZE_OVERRIDABLE: before assignment fd_setsize=1024, FD_SETSIZE=(int)1024\n!HAS_FD_SETSIZE_OVERRIDABLE: after assignment fd_setsize=1024 (was 1024) -- parameter was modified\nFINAL: calling internal_get_fdset2 with fd_sets\n</execution_log>\n\n<instruction>\nJudge whether the report is correct or not.\n</instruction>\n",
  "is_report_correct": true,
  "explanation": "The report is correct. fd_setsize is a non-pointer (value) function parameter (unsigned int) and the function assigns to it (e.g. fd_setsize = (unsigned int) INT_MAX; and fd_setsize = (int) FD_SETSIZE;), which constitutes modification of a function parameter. MISRA C 2023 Rule 17.8 explicitly forbids modifying non-pointer function parameters. The execution log also shows the parameter being changed. To comply, the code should use a local variable (for example: int local_fd_setsize = (int)fd_setsize;) and modify/pass that local variable instead of writing back to the parameter."
}