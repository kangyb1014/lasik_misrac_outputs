{
  "user_message": "An agent A claimed that the following ahc_echo code violates the MISRA C 2023 rule 21.17.\n<misra_rule>\nMISRA C 2023 Rule 21.17 is Use of the string handling functions from <string.h> shall not result in accesses beyond the bounds of the objects referenced by their pointer parameters.\nThis rule strictly applies to the Standard Library functions in <string.h> such as memcpy, memmove, memset, memcmp, strcpy, strncpy, strcat, strncat, strlen, and strspn.\n</misra_rule>\n<target_code>\nHere is the original code of ahc_echo.\n```c\nstatic enum MHD_Result\nahc_echo (void *cls,\n          struct MHD_Connection *connection,\n          const char *url,\n          const char *method,\n          const char *version,\n          const char *upload_data,\n          size_t *upload_data_size,\n          void **req_cls)\n{\n  static int aptr;\n  struct handler_param *param = (struct handler_param *) cls;\n  struct MHD_Response *response;\n  enum MHD_Result ret;\n\n  (void) url;               /* Unused. Silent compiler warning. */\n  (void) version;           /* Unused. Silent compiler warning. */\n  (void) upload_data;       /* Unused. Silent compiler warning. */\n  (void) upload_data_size;  /* Unused. Silent compiler warning. */\n\n  if (0 != strcmp (method, \"GET\"))\n    return MHD_NO;              /* unexpected method */\n  if (&aptr != *req_cls)\n  {\n    /* do never respond on first call */\n    *req_cls = &aptr;\n    return MHD_YES;\n  }\n  *req_cls = NULL;                  /* reset when done */\n  response =\n    MHD_create_response_from_buffer_static (strlen (param->response_page),\n                                            param->response_page);\n  ret = MHD_queue_response (connection,\n                            MHD_HTTP_OK,\n                            response);\n  MHD_destroy_response (response);\n  return ret;\n}\n```\n</target_code>\n<response format>\nProvide your answer with these fields.\n- explanation: your evaluation of the scenario provided by the agent A.\n- is_report_correct: whether the report is correct or not (true/false). True means there is a violation.\n</response format>\n<scenario>\nThe agent A provided the following violation scenario:\nThe code calls strcmp(method, \"GET\") without validating the pointer. If method is NULL (or if it points to a non\u2013NUL-terminated buffer shorter than 4 bytes), strcmp will read memory beyond the referenced object (dereferencing NULL or running past the buffer), violating Rule 21.17. The string literal \"GET\" is safe, but the unvalidated method parameter makes the call unsafe.\n</scenario>\n\n<instruction>\nJudge whether the report is correct or not.\n</instruction>\n",
  "is_report_correct": true,
  "explanation": "MISRA C:2023 Rule 21.17 requires that calls to string.h functions must not be able to read beyond the bounds of the objects referenced by their pointer parameters. The call strcmp(method, \"GET\") reads bytes from the object pointed to by method until it finds a NUL terminator. If method is NULL, or points to memory that is not a valid NUL-terminated string (e.g. a buffer lacking a terminator within its bounds), the call may dereference NULL or read past the end of the object, violating Rule 21.17. The string literal \"GET\" is safe, but the code contains no check that method != NULL or that method is a valid NUL-terminated string. Unless there is an externally guaranteed contract (from the caller/library) that method is always non-NULL and NUL-terminated, this use is unsafe. Therefore agent A\u2019s report is correct. Recommended fix: validate method (e.g. check method != NULL and that it is NUL-terminated or compare in a bounded/safe way) before calling strcmp."
}