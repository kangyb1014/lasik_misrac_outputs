{
  "user_message": "Target function code is:\n```c\nsize_t UT_Stub_CopyToLocal(UT_EntryKey_t FuncKey, void *LocalBuffer, size_t MaxSize)\n{\n    size_t               ActualCopy;\n    UT_StubTableEntry_t *StubPtr;\n\n    ActualCopy = 0;\n    StubPtr    = UT_GetStubEntry(FuncKey, UT_ENTRYTYPE_DATA_BUFFER);\n\n    if (StubPtr != NULL)\n    {\n        ActualCopy = StubPtr->Data.Buff.TotalSize - StubPtr->Data.Buff.Position;\n        if (MaxSize < ActualCopy)\n        {\n            ActualCopy = MaxSize;\n        }\n\n        memcpy(LocalBuffer, &StubPtr->Data.Buff.BasePtr[StubPtr->Data.Buff.Position], ActualCopy);\n        StubPtr->Data.Buff.Position += ActualCopy;\n\n        /*\n         * Once the buffer is completely copied then drop this entry.\n         * The test harness will either refill it or there might be\n         * another entry in the table.\n         */\n        if (StubPtr->Data.Buff.Position >= StubPtr->Data.Buff.TotalSize)\n        {\n            UT_ClearStubEntry(StubPtr);\n        }\n    }\n\n    return ActualCopy;\n}\n```\n\nStatic call graph of the target function is:\n```json\n{'UT_Stub_CopyToLocal': {'callees': ['UT_GetStubEntry', 'UT_ClearStubEntry'], 'callers': ['UT_DefaultHandler_OS_BinSemGetInfo', 'UT_DefaultHandler_OS_BinSemGetIdByName', 'UT_DefaultHandler_OS_GetLocalTime', 'UT_DefaultHandler_OS_CountSemGetIdByName', 'UT_DefaultHandler_OS_CountSemGetInfo', 'UT_DefaultHandler_OS_DirectoryRead', 'UT_DefaultHandler_OS_GetErrorName', 'UT_GenericReadStub', 'UT_DefaultHandler_OS_stat', 'UT_DefaultHandler_OS_FDGetInfo', 'UT_DefaultHandler_OS_FileSysStatVolume', 'UT_DefaultHandler_OS_TranslatePath', 'UT_DefaultHandler_OS_HeapGetInfo', 'UT_DefaultHandler_OS_ObjectIdToArrayIndex', 'UT_DefaultHandler_OS_GetResourceName', 'UT_DefaultHandler_OS_ForEachObjectOfType', 'UT_DefaultHandler_OS_ForEachObject', 'UT_DefaultHandler_OS_ModuleInfo', 'UT_DefaultHandler_OS_SymbolLookup', 'UT_DefaultHandler_OS_ModuleSymbolLookup', 'UT_DefaultHandler_OS_MutSemGetIdByName', 'UT_DefaultHandler_OS_MutSemGetInfo', 'UT_DefaultHandler_OS_NetworkGetHostName', 'UT_DefaultHandler_OS_QueueGet', 'UT_DefaultHandler_OS_QueueGetIdByName', 'UT_DefaultHandler_OS_QueueGetInfo', 'UT_DefaultHandler_OS_SocketRecvFrom', 'UT_DefaultHandler_OS_SocketGetIdByName', 'UT_DefaultHandler_OS_SocketGetInfo', 'UT_DefaultHandler_OS_SocketAddrInit', 'UT_DefaultHandler_OS_SocketAddrToString', 'UT_DefaultHandler_OS_SocketAddrFromString', 'UT_DefaultHandler_OS_SocketAddrGetPort', 'UT_DefaultHandler_OS_TaskGetIdByName', 'UT_DefaultHandler_OS_TaskGetInfo', 'UT_DefaultHandler_OS_TaskFindIdBySystemData', 'UT_DefaultHandler_OS_TimerGetIdByName', 'UT_DefaultHandler_OS_TimerGetInfo', 'UT_DefaultHandler_OS_TimeBaseGetIdByName', 'UT_DefaultHandler_OS_TimeBaseGetInfo', 'UT_DefaultHandler_OS_TimeBaseGetFreeRun']}, 'UT_GetStubEntry': {'callees': [], 'callers': ['UT_ConfigureGenericStubReturnValue', 'UT_ClearDeferredRetcode', 'UT_ClearDefaultReturnValue', 'UT_GetStubRetcodeAndCount', 'UT_GetStubCount', 'UT_Stub_RegisterReturnType', 'UT_Stub_GetReturnValuePtr', 'UT_SetDataBuffer', 'UT_GetDataBuffer', 'UT_Stub_CopyToLocal', 'UT_Stub_CopyFromLocal', 'UT_DoSetHookFunction', 'UT_Stub_RegisterContextWithMetaData', 'UT_Stub_CopyToReturnValue', 'UT_Stub_FindRetvalConfig', 'UT_DefaultStubImplWithArgs', 'UT_ExecuteBasicHandler', 'UT_ExecuteVaHandler']}, 'UT_ClearStubEntry': {'callees': [], 'callers': ['UT_ResetState', 'UT_ClearDeferredRetcode', 'UT_ClearDefaultReturnValue', 'UT_Stub_RegisterReturnType', 'UT_Stub_CopyToLocal', 'UT_Stub_CopyFromLocal', 'UT_DoSetHookFunction', 'UT_DefaultStubImplWithArgs']}, 'UT_DefaultHandler_OS_BinSemGetInfo': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_BinSemGetIdByName': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_GetLocalTime': {'callees': ['UT_Hook_GetArgPtr', 'UT_GetStubCount', 'UT_Stub_CopyToLocal', 'OS_TimeAssembleFromNanoseconds'], 'callers': []}, 'UT_DefaultHandler_OS_CountSemGetIdByName': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_CountSemGetInfo': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_DirectoryRead': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_GetErrorName': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_GenericReadStub': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_Stub_CopyToReturnValue'], 'callers': ['UT_DefaultHandler_OS_read', 'UT_DefaultHandler_OS_TimedRead']}, 'UT_DefaultHandler_OS_stat': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_FDGetInfo': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_FileSysStatVolume': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_TranslatePath': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_HeapGetInfo': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_ObjectIdToArrayIndex': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdDecompose'], 'callers': []}, 'UT_DefaultHandler_OS_GetResourceName': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_ForEachObjectOfType': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_ForEachObject': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_ModuleInfo': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_SymbolLookup': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_ModuleSymbolLookup': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_MutSemGetIdByName': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_MutSemGetInfo': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_NetworkGetHostName': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_QueueGet': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'OS_ObjectIdToInteger', 'UT_Stub_CopyToReturnValue'], 'callers': []}, 'UT_DefaultHandler_OS_QueueGetIdByName': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_QueueGetInfo': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_SocketRecvFrom': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_Stub_CopyToReturnValue'], 'callers': []}, 'UT_DefaultHandler_OS_SocketGetIdByName': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_SocketGetInfo': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_SocketAddrInit': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_SocketAddrToString': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_SocketAddrFromString': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_SocketAddrGetPort': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal'], 'callers': []}, 'UT_DefaultHandler_OS_TaskGetIdByName': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_TaskGetInfo': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_TaskFindIdBySystemData': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_TimerGetIdByName': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_TimerGetInfo': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_TimeBaseGetIdByName': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_TimeBaseGetInfo': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_ObjIdCompose'], 'callers': []}, 'UT_DefaultHandler_OS_TimeBaseGetFreeRun': {'callees': ['UT_Hook_GetArgPtr', 'UT_Stub_CopyToLocal', 'UT_GetStubCount'], 'callers': []}}\n```\n\n\nList additional symbols that are required to analyze the target function to determine if the target function code violates the following MISRA C rule:\nLanguage extensions should not be used. You should report only when the code uses any language compiler extensions that are explicitly stated as an extension in compiler documentations.\nThe list will be included in the prompt for the next agent, so be concise and clear.\nExplain why each symbol is required in the analysis of the target function for the MISRA C rule.\n",
  "close_symbols": [
    "UT_StubTableEntry_t",
    "UT_EntryKey_t",
    "UT_GetStubEntry",
    "UT_ClearStubEntry",
    "UT_ENTRYTYPE_DATA_BUFFER",
    "UT_StubTableEntry_t.Data.Buff.BasePtr",
    "memcpy",
    "size_t"
  ],
  "explanation": "To determine whether UT_Stub_CopyToLocal uses any compiler/language extensions the analyzer must see the definitions of the types/macros and called functions that appear in the code: \n\n- UT_StubTableEntry_t: required to inspect the layout and types of nested fields (Data, Buff, TotalSize, Position and BasePtr). In particular BasePtr's type (e.g. void * vs char *) is critical because indexing (BasePtr[Position]) is a GNU extension if BasePtr is void*. Also types of TotalSize/Position determine whether arithmetic triggers implementation-defined behavior. \n\n- UT_EntryKey_t: the underlying typedef could be defined using an extension (compiler attribute, typeof, etc.) or nonstandard integral type; need its definition to ensure no extensions are used. \n\n- UT_GetStubEntry: need the prototype/definition to ensure it is a normal function (not a macro using statement-expressions, typeof, inline assembly, GCC attributes, or other extensions) and that its return type matches the expected pointer type. \n\n- UT_ClearStubEntry: need the prototype/definition to check it is not a macro or inline construct that uses language extensions (e.g. statement expressions, typeof, attributes). The call site could hide an extension if ClearStubEntry is a macro. \n\n- UT_ENTRYTYPE_DATA_BUFFER: the macro/enum definition is needed in case it expands to something using compiler extensions or unusual constructs. \n\n- UT_StubTableEntry_t.Data.Buff.BasePtr: explicit emphasis on the BasePtr type (char *, uint8_t *, void *, etc.) because pointer arithmetic/indexing semantics differ and void-pointer indexing is a known compiler extension in some toolchains. \n\n- memcpy: need the declaration/definition (usually from <string.h>) to ensure the symbol used is the standard library function and not replaced by a macro or inline implementation that uses extensions. \n\n- size_t: need the typedef/definition to ensure it is the standard unsigned integer type from <stddef.h>/<stdint.h> and not redeclared via an extension.\n\nProviding these symbols/definitions allows the next agent to check for any use of language/compiler extensions (nonstandard pointer arithmetic, macros using statement-expressions, typeof, attributes, inline assembly, GCC-specific constructs, etc.) in the target function and in any macros or types it directly depends on."
}