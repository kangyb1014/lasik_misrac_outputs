{
  "user_message": "<misra_rule>\nMISRA C 2023 Rule 2.2 is: A project shall not contain dead code.\nAny operation that is executed but whose removal would not affect program behaviour constitutes dead code. Notes:\n1. The behaviour of an embedded sytem is often determined not just by the nature of its actions, but also by the time at which they occur.\n2. unreachable code is not dead code, as it cannot be executed.\n3.Initialization is not the same as an assignment operation and is therfore not a candidate for dead code.\n</misra_rule>\n<response format>\nProvide your answer with these fields.\n- is_rule_violated: whether the rule is violated or not (true/false),\n- scenario: a specific violation scenario.\n- test_code: a modified is_websocket_request code that contains useful probe functions that print useful logs to a file \"/tmp/logs/506.txt\". The logs should contain the control path and state information of the violation scenario. If the MISRA C rule is not violated, you can just return an empty string for the test code.\nHere are the constraints for the test code:\n- DO NOT introduce new violations to demonstrate your scenario.\n- The test code MUST be compilable and executable.\n- The test code MUST include line breaks.\n- The test code MUST preserve the original logic of is_websocket_request as much as possible.\n- You MUST NOT define the main function.\n- You MUST NOT define macros.\n- The test code MUST not contain any mock functions.\n</response format>\n<target_code>\nHere is the code of is_websocket_request:\n```c\nstatic enum MHD_Result\nis_websocket_request (struct MHD_Connection *con, const char *upg_header,\n                      const char *con_header)\n{\n\n  (void) con;  /* Unused. Silent compiler warning. */\n\n  return ((upg_header != NULL) && (con_header != NULL)\n          && (0 == strcmp (upg_header, WS_UPGRADE_VALUE))\n          && (NULL != strstr (con_header, \"Upgrade\")))\n         ? MHD_YES\n         : MHD_NO;\n}\n```\n</target_code>\n<additional code>Here are the definitions of symbols that are close to the target function is_websocket_request:\n#define WS_UPGRADE_VALUE \"websocket\"\n</additional code>\nJudge whether the above is_websocket_request code violates the rule 2.2 or not.",
  "is_rule_violated": true,
  "scenario": "In the function is_websocket_request, the parameter 'con' is not used except for being explicitly cast to void. This parameter serves no purpose in the function's logic and removing it would not alter the behavior, which means its presence constitutes dead code as per MISRA C 2023 Rule 2.2.",
  "test_code": "#include <stdio.h>\n#include <string.h>\n#include <stdlib.h>\n\nenum MHD_Result { MHD_NO = 0, MHD_YES = 1 };\n\n#define WS_UPGRADE_VALUE \"websocket\"\n\nstatic enum MHD_Result\nis_websocket_request (struct MHD_Connection *con, const char *upg_header,\n                      const char *con_header)\n{\n  FILE *log = fopen(\"/tmp/logs/506.txt\", \"a\");\n  if (log == NULL) {\n    return MHD_NO; // fail silently if log file can't open\n  }\n\n  // Log start and parameter states\n  fprintf(log, \"Entering is_websocket_request\\n\");\n  fprintf(log, \"Pointer con: %p (unused)\\n\", (void *)con);\n  fprintf(log, \"upg_header: %s\\n\", upg_header ? upg_header : \"NULL\");\n  fprintf(log, \"con_header: %s\\n\", con_header ? con_header : \"NULL\");\n\n  // The con parameter is cast to void intentionally,\n  // but it is never actually used otherwise.\n  (void) con;  /* Unused. Silent compiler warning. */\n\n  int condition = ((upg_header != NULL) && (con_header != NULL)\n                   && (0 == strcmp (upg_header, WS_UPGRADE_VALUE))\n                   && (NULL != strstr (con_header, \"Upgrade\")));\n\n  fprintf(log, \"Condition evaluation result: %d\\n\", condition);\n\n  enum MHD_Result result = condition ? MHD_YES : MHD_NO;\n\n  fprintf(log, \"Return result: %d\\n\", result);\n  fprintf(log, \"Exiting is_websocket_request\\n\\n\");\n  fclose(log);\n  return result;\n}\n\n// Note: struct MHD_Connection is not defined here as it is unused."
}